- **TEP**: [115](https://github.com/ton-blockchain/TEPs/blob/master/text/0115-ton-connect.md)
- **title**: TON Connect
- **статус**: Активна
- **type**: Ядро
- **authors**: @oleganza, @siandreev, subden, brainpicture, @sorokin0andrey, abogoslavskiy, @MariaBit, Olga May, Aleksei Mazelyuk, tonrostislav, KuznetsovNikita.
- **создан**: 20.10.2022
- **Заменяет**: -
- \*\*заменено \*\*: -

# Summary

TON Connect - это единый протокол для общения между кошельками TON и TON-приложениями.

# Мотивация

Открытой сети нужен **унифицированный** протокол для общения между кошельками TON и приложениями TON (d)для достижения следующих целей:

1. Любое приложение TON (веб-/ рабочий стол/мобильный / др.) может работать с любым кошельком (мобильный / настольный / веб-браузер / расширение / dapp браузер / аппаратное / т.д. ).

2. Пользователи получают знакомый и дружелюбный доступ ко всем приложениям TON.

# Инструкция

Приложения предоставляют пользовательский интерфейс бесконечному набору функций в TON на основе смарт-контрактов, но не имеют непосредственного доступа к средствам пользователей. Поэтому они часто называются децентрализованными приложениями или картами.

Кошельки предоставляют пользовательский интерфейс для подтверждения транзакций и надежного хранения криптографических ключей пользователей на их персональных устройствах.

Такое разделение проблем обеспечивает быстрое нововведение и высокий уровень безопасности для пользователей: кошелькам не нужно сами создавать огородные экосистемы, в то время как приложениям не нужно брать на себя риск, связанный с учетными записями конечных пользователей.

TON Connect - это мост, который пересекает этот концептуальный разрыв.

TON Connect, в дополнение к транспортному уровню связи между кошельком и приложением, предоставляет методы авторизации, отправки транзакций в сеть, взаимодействия с смарт-контрактами и т.д.

# Спецификация

Доки и спецификации находятся в [https://github.com/ton-blockchain/ton-connect](https://github.com/ton-blockchain/ton-connect) repo.

На момент создания этого PR (27 февраля, 2023) ревизия была `acc5dd4d2106891cbfcade8d7faa58b9e16937fd`.

# Обоснование и альтернативы

## Единый способ

Поскольку мы стремимся сделать блокчейн максимально удобным и удобным в использовании, общение между любым приложением и любым кошельком (мобильным приложением или дополнением для браузера) должно работать единым образом.

Это удобно не только для пользователей, но и для разработчиков кошельков и разработчиков dapps, , который должен поддерживать только один протокол.

Примеры других блокчейнов (напр. Ethereum), которые не смогли достичь единого сетевого стандарта показывает, что это путает пользователей и затрудняет для разработчиков: оба должны понимать различные типы кошельков и соединений.

## Сессии для богатых приложений

Простейшее "однодействие" взаимодействие между кошельком и dapp можно выполнить простым тоном:// deeplink, в данном варианте вообще невозможно получить ответ на запрос или события в режиме работы.

Так как богатые возможности необходимы для более сложных карт, TON Connect позволяет устанавливать постоянные соединения между кошельком и приложением, получать ответы и события.

## SSE

TON Connect использует SSE ([Server-Sent Events](https://html.spec.whatwg.org/multipage/server-sent-events. tml#server-sent-events)) протокол вместо websockets, потому что на практике существует множество проблем с подключением, которые не имеют гарантированного решения.

## Бэкэнд

Взаимодействие между кошельком и dapp без backend возможно только для браузера dapp или расширения браузера с локальным запуском dapp.

Если dapp и кошелек открываются на разных устройствах (например, приложение для открытия пользователя на рабочем столе и кошелек для мобильного) необходим посредник (ретранслятор или мост).

Учитывая предыдущую точку о едином протоколе для всех типов кошельков в целом, нам нужен бэкэнд посредник в TON Connect.

TON Connect использует простейший мост.

Все сообщения, проходящие через мост, шифруются сквозным шифрованием, что сохраняет конфиденциальность пользователей.

Браузеры Dapp и расширения браузера могут использовать мост JS без необходимости запуска backend-сервера, в то время как протокол остается совместимым для всех типов кошельков.

## Обычный публичный мост

TON Connect позволяет запускать общедоступный мост(ы), который может использовать любые кошельки и карты.

Этот вариант подходит для быстрой реализации TON Connect, но имеет несколько недостатков: публичный мост потенциально может получить IP адреса пользователей кошелька, некоторые кошельки могут захотеть получить дополнительную функциональность моста.

## Кошельки могут запускать и устанавливать собственный мост

TON Connect позволяет кошелькам запускать свой собственный мост, если они не хотят использовать публичный мост.

Каждый кошелек может поддерживать свой собственный мост сервер и свободно выбирать, как с ним общаться.

## Приложениям не нужно запускать мост

В Ton Connect приложениям не нужно поддерживать собственный бэкэнд для получения данных из кошельков.

Мы считаем, что разработчики кошельков имеют больше возможностей для постоянного хостинга серверов, чем разработчики dapp: многие dapps являются простыми безсерверными веб-страницами. Еще один аргумент заключается в том, что существует гораздо больше приложений, чем кошельков.

## Открыть, свободно, децентрализованно

Единый сетевой стандарт должен быть открытым и бесплатным.

Важно, чтобы децентрализация не зависела от того или иного сервера, компании или ее реализации.

Например, любой кошелек или dapp должны иметь возможность работать с этой технологией без чужого централизованного разрешения.

TON Connect удовлетворяет этим соображениям.

Мы можем привести пример противоположной концепции WalletConnect, где все кошельки и приложения должны общаться через один ретранслятор, принадлежащий конкретной организации. Возможность запуска вашего ретранслятора (моста) в WalletConnect находится в планах.

## Список кошельков

Для удобства разработчиков имеет смысл создать одну конфигурацию со списком всех кошельков и их данных (например, адрес моста).

Также, для удобства пользователя, пользовательский интерфейс может отображать кошельки из этого списка, если у пользователя еще не установлен кошелек.

Такой список находится в репозитории [https://github.com/ton-blockchain/wallets-list](https://github.com/ton-blockchain/wallets-list).

Правила для включения в этот список должны быть простыми - правильной технической реализации TON Connect.

Мы отмечаем, что сам протокол не зависит от этого списка.

Несмотря на некоторые аспекты централизации и возможные вопросы саморегулирования, такой перечень также будет способствовать перекрестной связи и единообразию экосистем.

# Будущие возможности

Дальнейшая разработка TON Connect ожидается в добавлении новых методов RPC, охватывающих различные функции.
